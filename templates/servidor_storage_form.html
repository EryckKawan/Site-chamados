{% extends "base.html" %}

{% block title %}{{ 'Editar' if action == 'editar' else 'Novo' }} Servidor{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">
                        <i class="bi bi-hdd-rack"></i> 
                        {{ 'Editar' if action == 'editar' else 'Adicionar' }} Servidor de Armazenamento
                    </h4>
                </div>
                <div class="card-body">
                    <form method="POST">
                        <!-- Nome do Servidor -->
                        <div class="mb-3">
                            <label for="nome" class="form-label">
                                <i class="bi bi-server"></i> Nome do Servidor *
                            </label>
                            <input type="text" 
                                   class="form-control" 
                                   id="nome" 
                                   name="nome" 
                                   value="{{ servidor.nome if servidor else '' }}"
                                   placeholder="Ex: SRV01, Servidor Principal, etc."
                                   required>
                            <small class="form-text text-muted">
                                Nome identificador do servidor
                            </small>
                        </div>

                        <!-- Capacidade Total -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="capacidade_valor" class="form-label">
                                        <i class="bi bi-hdd"></i> Capacidade Total *
                                    </label>
                                    <input type="number" 
                                           class="form-control" 
                                           id="capacidade_valor" 
                                           name="capacidade_valor" 
                                           value="{{ servidor.capacidade_valor if servidor else '' }}"
                                           step="0.01"
                                           min="0"
                                           placeholder="Ex: 1024"
                                           required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="capacidade_unidade" class="form-label">Unidade</label>
                                    <select class="form-select" id="capacidade_unidade" name="capacidade_unidade" required>
                                        <option value="GB" {{ 'selected' if servidor and servidor.capacidade_unidade == 'GB' else '' }}>GB (Gigabytes)</option>
                                        <option value="TB" {{ 'selected' if servidor and servidor.capacidade_unidade == 'TB' else '' }}>TB (Terabytes)</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Espaço Usado -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="usado_valor" class="form-label">
                                        <i class="bi bi-pie-chart"></i> Espaço Usado *
                                    </label>
                                    <input type="number" 
                                           class="form-control" 
                                           id="usado_valor" 
                                           name="usado_valor" 
                                           value="{{ servidor.usado_valor if servidor else '' }}"
                                           step="0.01"
                                           min="0"
                                           placeholder="Ex: 400"
                                           required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="usado_unidade" class="form-label">Unidade</label>
                                    <select class="form-select" id="usado_unidade" name="usado_unidade" required>
                                        <option value="GB" {{ 'selected' if servidor and servidor.usado_unidade == 'GB' else '' }}>GB (Gigabytes)</option>
                                        <option value="TB" {{ 'selected' if servidor and servidor.usado_unidade == 'TB' else '' }}>TB (Terabytes)</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Observações -->
                        <div class="mb-3">
                            <label for="observacoes" class="form-label">
                                <i class="bi bi-chat-text"></i> Observações (Opcional)
                            </label>
                            <textarea class="form-control" 
                                      id="observacoes" 
                                      name="observacoes" 
                                      rows="3"
                                      placeholder="Informações adicionais sobre o servidor...">{{ servidor.observacoes if servidor else '' }}</textarea>
                        </div>

                        <!-- Preview dos Cálculos -->
                        <div class="alert alert-info">
                            <h6><i class="bi bi-calculator"></i> Cálculos Automáticos:</h6>
                            <p class="mb-1"><strong>Conversões:</strong></p>
                            <ul class="mb-1">
                                <li>1 TB = 1024 GB</li>
                                <li>Espaço Livre = Capacidade - Usado</li>
                                <li>% Uso = (Usado / Capacidade) × 100</li>
                                <li>% Livre = 100 - % Uso</li>
                            </ul>
                            <p class="mb-0 text-muted">Os cálculos serão realizados automaticamente após salvar.</p>
                        </div>

                        <!-- Botões de Ação -->
                        <div class="d-flex justify-content-between">
                            <a href="{{ url_for('servidor_storage.listar') }}" class="btn btn-secondary">
                                <i class="bi bi-arrow-left"></i> Cancelar
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-save"></i> Salvar Servidor
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Card de Exemplo -->
            <div class="card mt-4 border-success">
                <div class="card-header bg-success text-white">
                    <h6 class="mb-0"><i class="bi bi-info-circle"></i> Exemplo de Funcionamento</h6>
                </div>
                <div class="card-body">
                    <p><strong>Entrada:</strong></p>
                    <ul>
                        <li>Servidor: SRV01</li>
                        <li>Capacidade: 1 TB</li>
                        <li>Usado: 400 GB</li>
                    </ul>
                    <p><strong>Saída esperada:</strong></p>
                    <ul>
                        <li>Capacidade em GB: <span class="text-primary"><strong>1024.00 GB</strong></span></li>
                        <li>Usado em GB: <span class="text-warning"><strong>400.00 GB</strong></span></li>
                        <li>Livre: <span class="text-success"><strong>624.00 GB</strong></span></li>
                        <li>% Uso: <span class="badge bg-success">39.06%</span></li>
                        <li>% Livre: <span class="badge bg-success">60.94%</span></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.card {
    border-radius: 10px;
}

.card-header {
    border-radius: 10px 10px 0 0 !important;
}

.form-label {
    font-weight: 600;
}

.alert-info {
    background-color: #e7f3ff;
    border-color: #b3d7ff;
}
</style>
{% endblock %}

